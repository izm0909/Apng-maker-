# APNG作成アプリ 実装計画

## 1. プロジェクト概要
1枚の静止画から背景を透過し、動きをつけてLINEのアニメーションスタンプ形式（APNG）で出力するWebアプリケーションを作成します。

## 2. 技術スタック
- **Framework**: Next.js (TypeScript)
- **Styling**: Vanilla CSS (モダンでリッチなデザイン)
- **背景削除**: `@imgly/background-removal`
- **APNG生成**: `upng-js` (Canvasからフレームデータを取得しエンコード)

## 3. 機能要件
1.  **画像アップロード**: ドラッグ＆ドロップで画像を読み込む。
2.  **背景透過処理**: アップロードされた画像の背景をAIで自動削除する。
3.  **アニメーション設定**:
    - プリセットの動きを選択（例：バウンド、横揺れ、拡大縮小、回転）。
    - パラメータ調整（速度、強度など）。
4.  **プレビュー**: 生成されるアニメーションをWeb上で確認。
5.  **エクスポート**: LINEスタンプの仕様に合わせたAPNGファイルをダウンロード。
    - サイズ: 最大 320x270 (自動リサイズ)
    - 容量: 300KB以下を目指す
    - 再生時間: 1〜4秒

## 4. 実装ステップ

### Phase 1: プロジェクトセットアップ
- [x] Next.js プロジェクトの初期化
- [x] 必要なライブラリのインストール (`@imgly/background-removal`, `upng-js` 等)
- [x] 基本的なディレクトリ構造とCSS変数の設定 (デザインシステム)

### Phase 2: UI構築 (Base)
- [x] ヘッダー、メインレイアウトの作成
- [x] 画像アップロードコンポーネントの実装
- [x] 編集・プレビュー画面のレイアウト作成

### Phase 3: コア機能実装 (背景透過)
- [x] `@imgly/background-removal` を用いた背景削除処理の実装
- [x] 透過画像のCanvasへの描画

### Phase 4: コア機能実装 (アニメーション & APNG)
- [x] Canvas上でのフレームアニメーション描画ロジックの実装
- [x] 複数フレームをキャプチャし、`upng-js` でAPNGバイナリに変換する処理
- [x] ダウンロード機能の実装

### Phase 5: UI/UX改善 & 最適化
- [x] ローディング表示、エラーハンドリング
- [x] デザインのブラッシュアップ (Glassmorphism, Animations)
- [x] LINEスタンプ仕様への適合チェック（サイズ、容量警告など）
- [x] デプロイ (Vercel)

### Phase 6: 追加機能 (テキスト合成)
- [x] テキスト入力・選択UIの実装
- [x] Canvasへのテキスト描画処理の実装
- [x] プリセットテキストの追加

## 5. デザインコンセプト
- **テーマ**: クリエイティブでモダンなツール。
- **カラー**: ダークモードベース、鮮やかなアクセントカラー（ネオン系やグラデーション）。
- **インタラクション**: スムーズなトランジション、ホバーエフェクト。
